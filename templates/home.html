{{template "base" .}}
{{define "content"}}

    <h1>SSH Hosts</h1>
    <table>
        <thead>
        <tr>
            <th>Name</th>
            <th>Address</th>
            <th>Username</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
            {{range .Hosts}}
                <tr data-host-id="{{.ID}}">
                    <td>{{.Name}}</td>
                    <td>{{.Address}}</td>
                    <td>{{.Username}}</td>
                    <td class="actions-cell">
                        {{ $isActive := index $.ActiveIDs .ID }}
                        <div class="btn-group" id="actions-{{.ID}}">
                            
                            <button id="resume-{{.ID}}" 
                                    onclick="connectToHost({{.ID}}, '{{.Name}}')" 
                                    style="background-color: #17a2b8; color: white; {{if not $isActive}}display: none;{{end}}">
                                Open Terminal
                            </button>

                            <button class="std-btn-{{.ID}}" 
                                    onclick="connectToHost({{.ID}}, '{{.Name}}')" 
                                    style="background-color: #28a745; color: white; {{if $isActive}}display: none;{{end}}">
                                Connect
                            </button>
                            <button class="std-btn-{{.ID}}" 
                                    onclick="openEditModal({{.ID}})" 
                                    style="{{if $isActive}}display: none;{{end}}">
                                Edit
                            </button>
                            <button class="std-btn-{{.ID}}" 
                                    onclick="openDeleteModal({{.ID}}, '{{.Name}}')" 
                                    style="{{if $isActive}}display: none;{{end}}">
                                Delete
                            </button>

                        </div>
                    </td>
                </tr>
            {{else}}
                <tr>
                    <td colspan="5">No hosts found</td>
                </tr>
            {{end}}
        </tbody>
    </table>
    <button onclick="openAddModal()">Add New Host</button>

    <div id="hostModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modalTitle">Add Host</h2>
            <form id="hostForm">
                <input type="hidden" id="csrf_token" value="{{.CSRFToken}}">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required><br>

                <label for="address">Address:</label>
                <input type="text" id="address" name="address" required><br>

                <label for="address">Port:</label>
                <input type="number" id="port" name="port" required><br>

                <label for="username">Username:</label>
                <input type="text" id="username" name="username" required><br>

                <div id="keyField" style="display:none;">
                    <label for="keyID">Private Key:</label>
                    <select id="keyID" name="keyID"></select><br>
                </div>

                <button type="submit">Save</button>
            </form>
        </div>
    </div>

    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeDeleteModal()">&times;</span>
            <h2>Delete Host</h2>
            <p>Enter the host name to confirm deletion:</p>
            <input type="text" id="deleteHostName" placeholder="Host Name">
            <button id="confirmDeleteBtn" disabled onclick="confirmDelete()">Delete</button>
        </div>
    </div>

    <div id="terminal-container" style="position: static;"></div>

{{end}}